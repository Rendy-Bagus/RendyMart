<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RenzzMart — Login / Daftar</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="auth-page">
    <div class="auth-card">
      <div class="brand">
        <img src="logo.png" alt="logo" class="logo" onerror="this.style.display='none'">
        <h1>RenzzMart</h1>
        <p class="muted">Masuk atau buat akun untuk mulai berbelanja</p>
      </div>

      <div class="tabs">
        <button id="tabLogin" class="tab active">Login</button>
        <button id="tabRegister" class="tab">Daftar</button>
      </div>

      <div id="loginBox" class="form">
        <input id="loginEmail" placeholder="Email atau Username" />
        <input id="loginPassword" type="password" placeholder="Password" />
        <button id="btnLogin" class="btn">Login</button>
        <div class="muted small" style="margin-top:8px">Atau langsung coba sebagai <button id="demoBtn" class="link">guest</button></div>
      </div>

      <div id="registerBox" class="form hidden">
        <input id="regName" placeholder="Nama (akan tampil di akun)" />
        <input id="regEmail" placeholder="Email" />
        <input id="regPassword" type="password" placeholder="Password (min 6)" />
        <input id="regConfirm" type="password" placeholder="Konfirmasi password" />
        <label class="small muted"><input id="isAdmin" type="checkbox"> Jadikan akun ini admin (hanya untuk demo)</label>
        <button id="btnRegister" class="btn teal">Daftar</button>
      </div>

      <div id="msg" class="muted small" style="margin-top:10px"></div>
    </div>

    <footer class="auth-footer muted">RenzzMart demo • Semua data tersimpan di browser (localStorage).</footer>
  </main>

  <script src="script.js"></script>
  <script>
    // Auth UI wiring (uses functions inside script.js)
    (function(){
      const $ = id => document.getElementById(id);
      const tabLogin = $('tabLogin'), tabRegister = $('tabRegister');
      const loginBox = $('loginBox'), registerBox = $('registerBox');
      const msg = $('msg');

      tabLogin.addEventListener('click', ()=>{ tabLogin.classList.add('active'); tabRegister.classList.remove('active'); loginBox.classList.remove('hidden'); registerBox.classList.add('hidden'); msg.textContent='';});
      tabRegister.addEventListener('click', ()=>{ tabRegister.classList.add('active'); tabLogin.classList.remove('active'); registerBox.classList.remove('hidden'); loginBox.classList.add('hidden'); msg.textContent='';});

      $('btnLogin').addEventListener('click', async ()=>{
        const id = $('loginEmail').value.trim();
        const pw = $('loginPassword').value;
        msg.textContent = 'Memproses...';
        const ok = await window.RenzzAuth.login(id,pw);
        if(ok.success){ msg.textContent = 'Login berhasil. Mengarahkan ke toko...'; setTimeout(()=> location.href='store.html',800); }
        else msg.textContent = 'Login gagal: ' + ok.error;
      });

      $('btnRegister').addEventListener('click', async ()=>{
        const name = $('regName').value.trim();
        const email = $('regEmail').value.trim();
        const pw = $('regPassword').value;
        const conf = $('regConfirm').value;
        const admin = $('isAdmin').checked;
        msg.textContent = 'Memproses pendaftaran...';
        const res = await window.RenzzAuth.register({name,email,password:pw,confirm:conf,isAdmin:admin});
        if(res.success){ msg.textContent = 'Akun dibuat. Silakan login.'; tabLogin.click(); } else msg.textContent = 'Daftar gagal: ' + res.error;
      });

      $('demoBtn').addEventListener('click', async ()=>{
        // create demo guest user if not exists and login
        const demo = await window.RenzzAuth.ensureGuest();
        if(demo) location.href='store.html';
      });
    })();
  </script>
</body>
</html>
